<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ØµÙØ­Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰</title>
    <link rel="icon" type="image/png" href="https://omartamer.netlify.app/ØµÙˆØ±Ø© Ø²Ø¹ÙŠÙ… Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©.png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet">
    <style>
        .desktop-header a:hover::after, img, video { width: 100% }
        body { margin: 0; font-family: Cairo, sans-serif; background: #f4f6f8; padding-bottom: 100px }
        .desktop-header, .main-header { background-color: #2c3e50; color: #fff; padding: 15px 20px; font-weight: 700; font-size: 18px }
        .desktop-header { display: flex; justify-content: space-between; align-items: center }
        .desktop-header a, .mobile-footer a { color: #fff; text-decoration: none; margin-right: 10px; cursor: pointer; font-size: 16px !important }
        .mobile-footer { display: none }
        .desktop-header a::after { content: ''; position: absolute; bottom: -3px; right: 0; width: 0; height: 2px; background-color: #fff; transition: width .3s }
        @media (max-width: 768px) {
            .desktop-header { display: none }
            .main-header { text-align: center }
            .mobile-footer { display: flex; justify-content: center; gap: 15px; position: fixed; bottom: 0; width: 100%; background-color: #2c3e50; color: #fff; padding: 10px 0; z-index: 1000 }
        }
        .content { padding: 20px }
        h2, h3 { text-align: center; color: #1e3799 }
        .media-box { background: #fff; padding: 15px; margin: 20px auto; max-width: 700px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0, 0, 0, .1) }
        img, video { border-radius: 8px; margin-top: 10px }
        .text-content { font-size: 16px; background-color: #f9f9f9; padding: 15px; border-radius: 8px; white-space: pre-wrap }
        .timestamp { font-size: 13px; color: #888; margin-top: 8px }
        .media-box:hover { transform: scale(1.03); box-shadow: 0 6px 20px rgba(0, 0, 0, .15) }
        .highlighted { border: 3px solid #3498db !important; box-shadow: 0 0 15px #2980b9 !important; position: relative }
        .highlighted .close-btn { display: block }
        .close-btn { position: absolute; top: 10px; right: 10px; background: #e74c3c; color: white; border: none; border-radius: 5px; padding: 4px 8px; cursor: pointer; display: none; z-index: 10 }
        .highlighted .close-btn:hover { background: #c0392b; box-shadow: 0 0 10px rgba(192, 57, 43, 0.5) }
         .timestamp {
      font-size: 14px;
      color: #888;
      margin-top: 10px;
    }
    .footer {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
      color: #555;
    }
    .footer a {
      color: #1e3799;
      text-decoration: none;
    }
    .footer a:hover {
      text-decoration: underline;
    }
    .footer p {
      margin: 5px 0;
    }
    .loading {
      font-size: 20px;
      color: #555;
    }
    </style>
</head>
<body>

<header class="desktop-header">
    <div>
        <a href='https://omartamer.netlify.app/contactnews'>Ø§Ù„ØªÙˆØ§ØµÙ„</a>
    </div>
    <div> Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§Ø®Ø¨Ø§Ø± (News)</div>
</header>

<div class="content">
    <h3>Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</h3>
    <div id="videoContainer"></div>
    <h3>Ø§Ù„ØµÙˆØ±</h3>
    <div id="imageContainer"></div>
    <h3>Ø§Ù„Ù†ØµÙˆØµ</h3>
    <div id="textContainer"></div>
</div>

     <div class="footer">
    <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù€Ù€(News)&copy; </p>
    <p>Developed by <a href="https://www.facebook.com/omar.tamer.adel">Omar Tamer</a></p>
  </div>

<header class="mobile-footer">
   <a href='https://omartamer.netlify.app/contactnews'>Ø§Ù„ØªÙˆØ§ØµÙ„</a></header>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCN9vN9zcPa6OCUnzin101OTtyOYBDSPEk",
        authDomain: "bluetooth-4791f.firebaseapp.com",
        projectId: "bluetooth-4791f",
        storageBucket: "bluetooth-4791f.firebasestorage.app",
        messagingSenderId: "80129288547",
        appId: "1:80129288547:web:05c480484ba5eb1b908b56",
        measurementId: "G-51VB9VFYFJ"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function formatTimestamp(e) {
        if (!e) return "";
        let t = e.toDate();
        return `${t.toLocaleDateString()} - ${t.toLocaleTimeString()}`;
    }

    function loadVideos() {
        let container = document.getElementById("videoContainer");
        container.innerHTML = "";
        db.collection("videos")
            .orderBy("timestamp", "desc")
            .get()
            .then((querySnapshot) => {
                querySnapshot.forEach((doc) => {
                    let data = doc.data();
                    let videoId = `video_${doc.id}`;
                    let box = document.createElement("div");
                    box.className = "media-box";
                    box.id = videoId;
                    box.style.position = "relative";
                    box.innerHTML = `
                        <h4>${data.name}</h4>
                        <video controls style="width: 100%; max-height: 70vh;">
                            <source src="${data.url}" type="video/mp4">
                            Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ.
                        </video>
                        <p class="timestamp">ğŸ“… ${formatTimestamp(data.timestamp)}</p>
                        <button onclick="copyLink('video', '${doc.id}', this)" style="margin-top:10px;background:#2980b9;color:#fff;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;">
                            ğŸ”— Ù…Ø´Ø§Ø±ÙƒØ©
                        </button>`;
                    container.appendChild(box);
                });
                highlightIfAnchorExists();
            });
    }

    function copyLink(type, docId, btn) {
        let prefix = "";
        if (type === "video") prefix = "video_";
        if (type === "img") prefix = "img_";
        if (type === "text") prefix = "text_";
        const newLink = `https://omartamer.netlify.app/single_video#${prefix}${docId}`;
        navigator.clipboard.writeText(newLink).then(() => {
            btn.innerText = "âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®";
            setTimeout(() => {
                btn.innerText = "ğŸ”— Ù…Ø´Ø§Ø±ÙƒØ©";
            }, 2000);
        });
    }

    function loadImages() {
        let container = document.getElementById("imageContainer");
        container.innerHTML = "";
        db.collection("images")
            .orderBy("timestamp", "desc")
            .get()
            .then((querySnapshot) => {
                querySnapshot.forEach((doc) => {
                    let data = doc.data();
                    let imageId = `image_${doc.id}`;
                    let box = document.createElement("div");
                    box.className = "media-box";
                    box.id = imageId;
                    box.innerHTML = `
                        <h4>${data.name}</h4>
                        <img src="${data.url}" alt="${data.name}" style="width: 100%; max-height: 70vh; border-radius: 8px;">
                        <p class="timestamp">ğŸ“… ${formatTimestamp(data.timestamp)}</p>
                        <button onclick="copyLink('img', '${doc.id}', this)" style="margin-top:10px;background:#2980b9;color:#fff;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;">
                            ğŸ”— Ù…Ø´Ø§Ø±ÙƒØ©
                        </button>`;
                    container.appendChild(box);
                });
            });
    }

    function loadTexts() {
        let container = document.getElementById("textContainer");
        container.innerHTML = "";
        db.collection("texts")
            .orderBy("timestamp", "desc")
            .get()
            .then((querySnapshot) => {
                querySnapshot.forEach((doc) => {
                    let data = doc.data();
                    let textId = `text_${doc.id}`;
                    let box = document.createElement("div");
                    box.className = "media-box";
                    box.id = textId;
                    box.innerHTML = `
                        <div class="text-content">${data.content}</div>
                        <p class="timestamp">ğŸ“… ${formatTimestamp(data.timestamp)}</p>
                        <button onclick="copyLink('text', '${doc.id}', this)" style="margin-top:10px;background:#2980b9;color:#fff;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;">
                            ğŸ”— Ù…Ø´Ø§Ø±ÙƒØ©
                        </button>`;
                    container.appendChild(box);
                });
            });
    }

    function highlightIfAnchorExists() {
        const hash = location.hash;
        if (hash) {
            const target = document.querySelector(hash);
            if (target) {
                target.classList.add("highlighted");
                if (!target.querySelector('.close-btn')) {
                    const closeBtn = document.createElement('button');
                    closeBtn.className = 'close-btn';
                    closeBtn.innerText = 'âŒ';
                    closeBtn.onclick = () => {
                        target.style.display = 'none';
                        window.history.pushState('', document.title, window.location.pathname);
                    };
                    target.appendChild(closeBtn);
                }
                target.scrollIntoView({ behavior: "smooth", block: "center" });
            }
        }
    }

    loadVideos();
    loadImages();
    loadTexts();
</script>

</body>
</html>
