<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¬Ù€Ù†Ù‰ Ø¹Ù€Ø·ÙŠÙ‡</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    body {
      background: #121212;
      color: white;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    header {
      text-align: center;
      padding: 20px;
      font-size: 1.8rem;
      font-weight: bold;
      background: #6a11cb;
      border-radius: 15px;
      margin-bottom: 20px;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    header h1 {
      margin: 0;
    }
    .lang-switch {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      padding: 8px 15px;
      border-radius: 50px;
      cursor: pointer;
      font-weight: bold;
    }
    .card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 20px;
      margin: 15px 0;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }
    input, button, textarea {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      border: none;
      border-radius: 10px;
    }
    input, textarea {
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }
    .btn {
      padding: 12px;
      border: none;
      border-radius: 50px;
      background: #ff2a6d;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    .btn:hover {
      transform: scale(1.05);
    }
    .btn-secondary {
      background: #3498db;
    }
    .art-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }
    .logout-btn {
      background: #e74c3c;
    }
    .tab-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    .tab-buttons button {
      flex: 1;
      padding: 12px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      border-radius: 10px;
    }
    .tab-buttons button.active {
      background: #6a11cb;
    }
    .img-preview {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 10px;
      margin: 10px 0;
    }
    .error-message {
      color: #e74c3c;
      text-align: center;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <header>
    <h1 id="admin-title">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¬Ù€Ù†Ù‰ Ø¹Ù€Ø·ÙŠÙ‡</h1>
    <button class="lang-switch" id="lang-btn" onclick="toggleLanguage()">EN</button>
  </header>

  <div class="container" id="admin-app">
    <!-- ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
  </div>

  <script>
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ØºØ©
    let lang = localStorage.getItem('app-lang') || 'ar';

    // ØªØ±Ø¬Ù…Ø§Øª
    const t = {
      ar: {
        loginTitle: 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø§Ù„Ùƒ',
        username: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
        password: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
        login: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        back: 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
        artworks: 'Ø§Ù„Ù„ÙˆØ­Ø§Øª',
        poetry: 'Ø§Ù„Ø´Ø¹Ø±',
        logout: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬',
        addArt: 'Ø¥Ø¶Ø§ÙØ© Ù„ÙˆØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©',
        title: 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù„ÙˆØ­Ø©',
        price: 'Ø§Ù„Ø³Ø¹Ø± (Ø¬.Ù…)',
        image: 'Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©',
        category: 'Ø§Ù„ÙØ¦Ø©',
        digital: 'Ø§Ù„ÙÙ† Ø§Ù„Ø±Ù‚Ù…ÙŠ',
        customized: 'Ø§Ù„ÙÙ† Ø§Ù„Ù…Ø®ØµØµ',
        description: 'Ø§Ù„ÙˆØµÙ',
        add: 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„ÙˆØ­Ø©',
        current: 'Ø§Ù„Ù„ÙˆØ­Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©',
        delete: 'Ø­Ø°Ù',
        addPoem: 'Ø¥Ø¶Ø§ÙØ© Ù‚ØµÙŠØ¯Ø© Ø¬Ø¯ÙŠØ¯Ø©',
        poemTitle: 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚ØµÙŠØ¯Ø©',
        poemContent: 'Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù‚ØµÙŠØ¯Ø©',
        addPoemBtn: 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚ØµÙŠØ¯Ø©',
        poemsCurrent: 'Ø§Ù„Ù‚ØµØ§Ø¦Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠØ©',
        confirmDelete: 'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù‚ØµÙŠØ¯Ø©ØŸ',
        loginFailed: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
        artworkAdded: 'ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù„ÙˆØ­Ø©!',
        artworkDeleted: 'ØªÙ… Ø§Ù„Ø­Ø°Ù',
        poemAdded: 'ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚ØµÙŠØ¯Ø©!',
        poemDeleted: 'ØªÙ… Ø§Ù„Ø­Ø°Ù'
      },
      en: {
        loginTitle: 'Admin Login',
        username: 'Username',
        password: 'Password',
        login: 'Login',
        back: 'Back to Home',
        artworks: 'Artworks',
        poetry: 'Poetry',
        logout: 'Logout',
        addArt: 'Add New Artwork',
        title: 'Artwork Title',
        price: 'Price (EGP)',
        image: 'Image URL',
        category: 'Category',
        digital: 'Digital Art',
        customized: 'Customized Art',
        description: 'Description',
        add: 'Add Artwork',
        current: 'Current Artworks',
        delete: 'Delete',
        addPoem: 'Add New Poem',
        poemTitle: 'Poem Title',
        poemContent: 'Poem Content',
        addPoemBtn: 'Add Poem',
        poemsCurrent: 'Current Poems',
        confirmDelete: 'Are you sure you want to delete this poem?',
        loginFailed: 'Invalid username or password',
        artworkAdded: 'Artwork added!',
        artworkDeleted: 'Deleted successfully',
        poemAdded: 'Poem added!',
        poemDeleted: 'Deleted successfully'
      }
    };

    function updateTexts() {
      document.getElementById('admin-title').textContent = lang === 'ar' ? 'Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¬Ù€Ù†Ù‰ Ø¹Ù€Ø·ÙŠÙ‡' : 'Jana Attia Admin Panel';
      document.getElementById('lang-btn').textContent = lang === 'ar' ? 'EN' : 'AR';
    }

    function toggleLanguage() {
      lang = lang === 'ar' ? 'en' : 'ar';
      localStorage.setItem('app-lang', lang);
      location.reload();
    }

    // --- Ø¥ØµÙ„Ø§Ø­ Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© ---
    function goBackSafely() {
      // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1: Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
      if (window.history.length > 1) {
        window.history.back();
      } else {
        // Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2: Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
        window.location.href = 'index.html';
      }
    }

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„
    const ADMIN_USER = "janaattia@123";
    const ADMIN_PASS = "jana123";

    // ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    function checkAuth() {
      const isLoggedIn = localStorage.getItem('admin_logged_in') === 'true';
      if (!isLoggedIn) {
        showLogin();
      } else {
        showAdminPanel();
      }
    }

    // Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„
    function showLogin() {
      const app = document.getElementById('admin-app');
      if (!app) {
        document.body.innerHTML = `
          <div class="error-message">
            Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©. <br>
            <button onclick="goBackSafely()" class="btn">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
          </div>
        `;
        return;
      }

      app.innerHTML = `
        <div class="card" style="max-width: 420px; margin: 50px auto; text-align: center;">
          <h2 style="margin-bottom: 20px;">ğŸ” ${t[lang].loginTitle}</h2>
          <form onsubmit="event.preventDefault(); login();">
            <input type="text" id="username" placeholder="${t[lang].username}" required />
            <input type="password" id="password" placeholder="${t[lang].password}" required />
            <button type="submit" class="btn" style="width: 100%; margin: 15px 0;">
              ${t[lang].login}
            </button>
          </form>
          <button onclick="goBackSafely()" class="btn btn-secondary" style="width: 100%;">
            â† ${t[lang].back}
          </button>
        </div>
      `;
      updateTexts();
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    function login() {
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      if (username === ADMIN_USER && password === ADMIN_PASS) {
        localStorage.setItem('admin_logged_in', 'true');
        showAdminPanel();
      } else {
        alert(t[lang].loginFailed);
      }
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    function logout() {
      localStorage.removeItem('admin_logged_in');
      location.reload();
    }

    // Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    function showAdminPanel() {
      const artworks = JSON.parse(localStorage.getItem('artworks')) || [];
      const poems = JSON.parse(localStorage.getItem('poems')) || [];
      let activeTab = "artworks";

      renderTabs();

      function renderTabs() {
        const app = document.getElementById('admin-app');
        if (!app) return;

        app.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <div class="tab-buttons">
              <button class="${activeTab === 'artworks' ? 'active' : ''}" onclick="changeTab('artworks')">${t[lang].artworks}</button>
              <button class="${activeTab === 'poems' ? 'active' : ''}" onclick="changeTab('poems')">${t[lang].poetry}</button>
            </div>
            <button onclick="logout()" class="btn logout-btn">${t[lang].logout}</button>
          </div>
        ` + (activeTab === 'artworks' ? renderArtworksTab() : renderPoemsTab());
        updateTexts();
      }

      function renderArtworksTab() {
        let html = `
          <div class="card">
            <h3>${t[lang].addArt}</h3>
            <input type="text" id="new-title" placeholder="${t[lang].title}" />
            <input type="number" id="new-price" placeholder="${t[lang].price}" />
            <input type="url" id="new-image" placeholder="${t[lang].image}" value="https://source.unsplash.com/random/300x400/?art" />
            <select id="new-category">
              <option value="Ø§Ù„ÙÙ† Ø§Ù„Ø±Ù‚Ù…ÙŠ">${t[lang].digital}</option>
              <option value="Ø§Ù„ÙÙ† Ø§Ù„Ù…Ø®ØµØµ">${t[lang].customized}</option>
            </select>
            <textarea id="new-description" placeholder="${t[lang].description}" rows="2"></textarea>
            <button onclick="addArtwork()" class="btn">${t[lang].add}</button>
          </div>

          <h3 style="margin: 20px 0;">${t[lang].current} (${artworks.length})</h3>
          <div class="art-grid">
        `;
        artworks.forEach(art => {
          html += `
            <div class="card">
              <img src="${art.image}" alt="${art.title}" class="img-preview" />
              <h3>${art.title}</h3>
              <p>${art.category}</p>
              <p><strong>${art.price} Ø¬.Ù…</strong></p>
              <button onclick="deleteArtwork(${art.id})" class="btn" style="background: #e74c3c;">
                ${t[lang].delete}
              </button>
            </div>
          `;
        });
        html += `</div>`;
        return html;
      }

      function renderPoemsTab() {
        let html = `
          <div class="card">
            <h3>${t[lang].addPoem}</h3>
            <input type="text" id="new-poem-title" placeholder="${t[lang].poemTitle}" />
            <textarea id="new-poem-content" placeholder="${t[lang].poemContent}" rows="6"></textarea>
            <button onclick="addPoem()" class="btn">${t[lang].addPoemBtn}</button>
          </div>

          <h3 style="margin: 20px 0;">${t[lang].poemsCurrent} (${poems.length})</h3>
        `;
        poems.forEach(poem => {
          html += `
            <div class="card">
              <h3>${poem.title}</h3>
              <pre style="white-space: pre-line; margin: 10px 0; line-height: 2;">${poem.content}</pre>
              <button onclick="deletePoem(${poem.id})" class="btn" style="background: #e74c3c;">
                ${t[lang].delete}
              </button>
            </div>
          `;
        });
        return html;
      }

      window.changeTab = (tab) => {
        activeTab = tab;
        renderTabs();
      };

      window.addArtwork = () => {
        const title = document.getElementById("new-title").value;
        const price = document.getElementById("new-price").value;
        const image = document.getElementById("new-image").value;
        const category = document.getElementById("new-category").value;
        const description = document.getElementById("new-description").value;

        if (!title || !price || !image) {
          alert("Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
          return;
        }

        const artworks = JSON.parse(localStorage.getItem('artworks')) || [];
        const newArt = {
          id: Date.now(),
          title,
          price: parseFloat(price),
          image,
          category,
          description: description || "Ø¹Ù…Ù„ ÙÙ†ÙŠ Ø¬Ø¯ÙŠØ¯"
        };

        artworks.unshift(newArt);
        localStorage.setItem('artworks', JSON.stringify(artworks));
        alert(t[lang].artworkAdded);
        showAdminPanel();
      };

      window.addPoem = () => {
        const title = document.getElementById("new-poem-title").value;
        const content = document.getElementById("new-poem-content").value;

        if (!title || !content) {
          alert("Ø§Ù…Ù„Ø£ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰");
          return;
        }

        const poems = JSON.parse(localStorage.getItem('poems')) || [];
        const newPoem = {
          id: Date.now(),
          title,
          content
        };

        poems.unshift(newPoem);
        localStorage.setItem('poems', JSON.stringify(poems));
        alert(t[lang].poemAdded);
        showAdminPanel();
      };

      window.deleteArtwork = (id) => {
        if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù„ÙˆØ­Ø©ØŸ")) {
          let artworks = JSON.parse(localStorage.getItem('artworks')) || [];
          artworks = artworks.filter(a => a.id !== id);
          localStorage.setItem('artworks', JSON.stringify(artworks));

          let cart = JSON.parse(localStorage.getItem('cart')) || [];
          cart = cart.filter(a => a.id !== id);
          localStorage.setItem('cart', JSON.stringify(cart));

          let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
          wishlist = wishlist.filter(a => a.id !== id);
          localStorage.setItem('wishlist', JSON.stringify(wishlist));

          alert(t[lang].artworkDeleted);
          showAdminPanel();
        }
      };

      window.deletePoem = (id) => {
        if (confirm(t[lang].confirmDelete)) {
          let poems = JSON.parse(localStorage.getItem('poems')) || [];
          poems = poems.filter(p => p.id !== id);
          localStorage.setItem('poems', JSON.stringify(poems));
          alert(t[lang].poemDeleted);
          showAdminPanel();
        }
      };
    }

    // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ù‚Ù‚
    try {
      checkAuth();
    } catch (e) {
      console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©:", e);
      document.getElementById('admin-app').innerHTML = `
        <div class="error-message">
          Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„. <br>
          <button onclick="goBackSafely()" class="btn">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
      `;
    }
  </script>
</body>
</html>