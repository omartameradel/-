<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>محتوى عمر تامر</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; font-family: 'Cairo', sans-serif; background: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
    .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 90%; max-width: 600px; text-align: center; }
    img, video { width: 100%; border-radius: 10px; margin-top: 15px; }
    .text-content { background: #f9f9f9; padding: 15px; border-right: 5px solid #1e3799; text-align: right; margin-top: 15px; font-size: 18px; white-space: pre-wrap; }
    h2 { color: #1e3799; margin: 0; }
    .error { color: red; font-weight: bold; }
  </style>
</head>
<body>

  <div class="card" id="display">
    <div id="status">جاري التحميل...</div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <script>
    // إعداداتك الأصلية
    const firebaseConfig = {
      apiKey: "AIzaSyDTyEZBO2U2UTWl-DJuJgYrS0oiKEDr6Jw",
      authDomain: "ahmed-saeed-669ab.firebaseapp.com",
      projectId: "ahmed-saeed-669ab"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    async function showContent() {
      const display = document.getElementById('display');
      const hash = window.location.hash; // يقرأ ما بعد الـ #

      // لو الرابط فاضي
      if (!hash || !hash.includes('_')) {
        display.innerHTML = '<p class="error">الرابط ناقص! <br> جرب تفتح الرابط بالشكل ده: <br> index.html#img_ID </p>';
        return;
      }

      const type = hash.split('_')[0].replace('#', ''); // يستخرج img أو video أو text
      const id = hash.split('_')[1]; // يستخرج الـ ID

      // تحديد المجموعة
      let col = "";
      if (type === "img") col = "images";
      else if (type === "video") col = "videos";
      else if (type === "text") col = "texts";

      if (col === "") {
        display.innerHTML = '<p class="error">نوع الرابط غير معروف! استخدم img أو video أو text</p>';
        return;
      }

      try {
        const doc = await db.collection(col).doc(id).get();
        if (doc.exists) {
          const data = doc.data();
          let contentHtml = `<h2>${data.name || 'محتوى'}</h2>`;

          if (type === "img") {
            contentHtml += `<img src="${data.url}">`;
          } else if (type === "video") {
            contentHtml += `<video controls autoplay><source src="${data.url}" type="video/mp4"></video>`;
          } else if (type === "text") {
            contentHtml += `<div class="text-content">${data.content}</div>`;
          }

          display.innerHTML = contentHtml;
        } else {
          display.innerHTML = `<p class="error">لم نجد بيانات بهذا الـ ID في مجموعة (${col})</p>`;
        }
      } catch (e) {
        display.innerHTML = '<p class="error">حدث خطأ في الاتصال بالفايربيز</p>';
      }
    }

    window.onload = showContent;
    window.onhashchange = showContent;
  </script>
</body>
</html>
